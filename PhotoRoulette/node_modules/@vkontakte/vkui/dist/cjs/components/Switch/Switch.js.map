{"version":3,"sources":["../../../../src/components/Switch/Switch.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useAdaptivity } from '../../hooks/useAdaptivity';\nimport { useFocusVisible } from '../../hooks/useFocusVisible';\nimport { useFocusVisibleClassName } from '../../hooks/useFocusVisibleClassName';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { callMultiple } from '../../lib/callMultiple';\nimport type { HasRef, HasRootRef } from '../../types';\nimport { VisuallyHidden, type VisuallyHiddenProps } from '../VisuallyHidden/VisuallyHidden';\nimport styles from './Switch.module.css';\n\nconst sizeYClassNames = {\n  none: styles['Switch--sizeY-none'],\n  compact: styles['Switch--sizeY-compact'],\n};\n\nexport interface SwitchProps\n  extends React.InputHTMLAttributes<HTMLInputElement>,\n    HasRootRef<HTMLLabelElement>,\n    HasRef<HTMLInputElement> {}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/Switch\n */\nexport const Switch = ({\n  style,\n  className,\n  getRootRef,\n  getRef,\n  checked: checkedProp,\n  disabled,\n  onBlur: onBlurProp,\n  onFocus: onFocusProp,\n  onClick,\n  ...restProps\n}: SwitchProps): React.ReactNode => {\n  const platform = usePlatform();\n  const { sizeY = 'none' } = useAdaptivity();\n  const { focusVisible, onBlur, onFocus } = useFocusVisible();\n  const focusVisibleClassNames = useFocusVisibleClassName({ focusVisible, mode: 'outside' });\n  const handleBlur = callMultiple(onBlur, onBlurProp);\n  const handleFocus = callMultiple(onFocus, onFocusProp);\n\n  const [localUncontrolledChecked, setLocalUncontrolledChecked] = React.useState(\n    Boolean(restProps.defaultChecked),\n  );\n  const isControlled = checkedProp !== undefined;\n\n  const syncUncontrolledCheckedStateOnClick = React.useCallback(\n    (e: React.MouseEvent<HTMLInputElement>) => {\n      if (isControlled) {\n        return;\n      }\n\n      const switchTarget = e.target as HTMLInputElement;\n      setLocalUncontrolledChecked(switchTarget.checked);\n    },\n    [isControlled],\n  );\n\n  const inputProps: VisuallyHiddenProps<HTMLInputElement> = {\n    ...restProps,\n    Component: 'input',\n    getRootRef: getRef,\n    type: 'checkbox',\n    role: 'switch',\n    disabled: disabled,\n    onBlur: onBlurProp,\n    onFocus: onFocusProp,\n    onClick: callMultiple(syncUncontrolledCheckedStateOnClick, onClick),\n  };\n\n  if (isControlled) {\n    inputProps.checked = checkedProp;\n    inputProps['aria-checked'] = checkedProp ? 'true' : 'false';\n  } else {\n    inputProps['aria-checked'] = localUncontrolledChecked ? 'true' : 'false';\n  }\n\n  return (\n    <label\n      className={classNames(\n        styles['Switch'],\n        sizeY !== 'regular' && sizeYClassNames[sizeY],\n        platform === 'ios' ? styles['Switch--ios'] : styles['Switch--default'],\n        disabled && styles['Switch--disabled'],\n        focusVisibleClassNames,\n        className,\n      )}\n      style={style}\n      ref={getRootRef}\n    >\n      <VisuallyHidden\n        {...inputProps}\n        className={styles['Switch__inputNative']}\n        onBlur={handleBlur}\n        onFocus={handleFocus}\n      />\n      <span aria-hidden className={styles['Switch__inputFake']}>\n        <span className={styles['Switch__track']} />\n        <span\n          aria-hidden\n          className={classNames(\n            styles['Switch__handle'],\n            platform !== 'ios' && !disabled && styles['Switch__handle--withRipple'],\n          )}\n        />\n      </span>\n    </label>\n  );\n};\n"],"names":["Switch","sizeYClassNames","none","compact","style","className","getRootRef","getRef","checked","checkedProp","disabled","onBlur","onBlurProp","onFocus","onFocusProp","onClick","restProps","platform","usePlatform","sizeY","useAdaptivity","focusVisible","useFocusVisible","focusVisibleClassNames","useFocusVisibleClassName","mode","handleBlur","callMultiple","handleFocus","localUncontrolledChecked","setLocalUncontrolledChecked","React","useState","Boolean","defaultChecked","isControlled","undefined","syncUncontrolledCheckedStateOnClick","useCallback","e","switchTarget","target","inputProps","Component","type","role","label","classNames","ref","VisuallyHidden","span","aria-hidden"],"mappings":";;;;+BAwBaA;;;eAAAA;;;;;;;;iEAxBU;sBACI;+BACG;iCACE;0CACS;6BACb;8BACC;gCAE4B;AAGzD,MAAMC,kBAAkB;IACtBC,IAAI;IACJC,OAAO;AACT;AAUO,MAAMH,SAAS;QAAC,EACrBI,KAAK,EACLC,SAAS,EACTC,UAAU,EACVC,MAAM,EACNC,SAASC,WAAW,EACpBC,QAAQ,EACRC,QAAQC,UAAU,EAClBC,SAASC,WAAW,EACpBC,OAAO,EAEK,WADTC;QATHZ;QACAC;QACAC;QACAC;QACAC;QACAE;QACAC;QACAE;QACAE;;IAGA,MAAME,WAAWC,IAAAA,wBAAW;IAC5B,MAAM,EAAEC,QAAQ,MAAM,EAAE,GAAGC,IAAAA,4BAAa;IACxC,MAAM,EAAEC,YAAY,EAAEV,MAAM,EAAEE,OAAO,EAAE,GAAGS,IAAAA,gCAAe;IACzD,MAAMC,yBAAyBC,IAAAA,kDAAwB,EAAC;QAAEH;QAAcI,MAAM;IAAU;IACxF,MAAMC,aAAaC,IAAAA,0BAAY,EAAChB,QAAQC;IACxC,MAAMgB,cAAcD,IAAAA,0BAAY,EAACd,SAASC;IAE1C,MAAM,CAACe,0BAA0BC,4BAA4B,GAAGC,OAAMC,QAAQ,CAC5EC,QAAQjB,UAAUkB,cAAc;IAElC,MAAMC,eAAe1B,gBAAgB2B;IAErC,MAAMC,sCAAsCN,OAAMO,WAAW,CAC3D,CAACC;QACC,IAAIJ,cAAc;YAChB;QACF;QAEA,MAAMK,eAAeD,EAAEE,MAAM;QAC7BX,4BAA4BU,aAAahC,OAAO;IAClD,GACA;QAAC2B;KAAa;IAGhB,MAAMO,aAAoD,4CACrD1B;QACH2B,WAAW;QACXrC,YAAYC;QACZqC,MAAM;QACNC,MAAM;QACNnC,UAAUA;QACVC,QAAQC;QACRC,SAASC;QACTC,SAASY,IAAAA,0BAAY,EAACU,qCAAqCtB;;IAG7D,IAAIoB,cAAc;QAChBO,WAAWlC,OAAO,GAAGC;QACrBiC,UAAU,CAAC,eAAe,GAAGjC,cAAc,SAAS;IACtD,OAAO;QACLiC,UAAU,CAAC,eAAe,GAAGb,2BAA2B,SAAS;IACnE;IAEA,qBACE,sBAACiB;QACCzC,WAAW0C,IAAAA,gBAAU,gBAEnB5B,UAAU,aAAalB,eAAe,CAACkB,MAAM,EAC7CF,aAAa,mDACbP,oCACAa,wBACAlB;QAEFD,OAAOA;QACP4C,KAAK1C;;0BAEL,qBAAC2C,8BAAc,8CACTP;gBACJrC,SAAS;gBACTM,QAAQe;gBACRb,SAASe;;0BAEX,sBAACsB;gBAAKC,aAAW;gBAAC9C,SAAS;;kCACzB,qBAAC6C;wBAAK7C,SAAS;;kCACf,qBAAC6C;wBACCC,aAAW;wBACX9C,WAAW0C,IAAAA,gBAAU,wBAEnB9B,aAAa,SAAS,CAACP;;;;;;AAMnC"}