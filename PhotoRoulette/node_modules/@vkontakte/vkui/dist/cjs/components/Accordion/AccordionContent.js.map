{"version":3,"sources":["../../../../src/components/Accordion/AccordionContent.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { useCSSKeyframesAnimationController } from '../../lib/animation';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport type { HasRef, HasRootRef } from '../../types';\nimport { AccordionContext } from './AccordionContext';\nimport styles from './Accordion.module.css';\n\nconst CUSTOM_PROPERTY_ACCORDION_CONTENT_HEIGHT = '--vkui_internal--AccordionContent_height';\n\nconst stateClassNames = {\n  enter: styles['AccordionContent__in--enter'],\n  entering: styles['AccordionContent__in--enter'],\n  entered: styles['AccordionContent__in--entered'],\n  exit: styles['AccordionContent__in--exit'],\n  exiting: styles['AccordionContent__in--exit'],\n  exited: styles['AccordionContent__in--exited'],\n};\n\nexport interface AccordionContentProps\n  extends HasRootRef<HTMLDivElement>,\n    HasRef<HTMLDivElement>,\n    React.HTMLAttributes<HTMLDivElement> {}\n\nexport const AccordionContent: React.FC<AccordionContentProps> = ({\n  getRootRef,\n  getRef,\n  className,\n  children,\n  ...restProps\n}) => {\n  const { expanded, labelId, contentId } = React.useContext(AccordionContext);\n\n  const inRef = useExternRef(getRef);\n  const [animationState, animationHandlers] = useCSSKeyframesAnimationController(\n    expanded ? 'enter' : 'exit',\n    undefined,\n    true,\n  );\n\n  useIsomorphicLayoutEffect(() => {\n    const inEl = inRef.current;\n\n    /* istanbul ignore if: невозможный кейс (в SSR вызова этой функции не будет) */\n    if (!inEl) {\n      return;\n    }\n\n    switch (animationState) {\n      case 'enter':\n      case 'exit':\n        inEl.style.setProperty(CUSTOM_PROPERTY_ACCORDION_CONTENT_HEIGHT, `${inEl.scrollHeight}px`);\n        break;\n      case 'entered':\n      case 'exited':\n        inEl.style.removeProperty(CUSTOM_PROPERTY_ACCORDION_CONTENT_HEIGHT);\n        break;\n    }\n  }, [animationState, inRef]);\n\n  return (\n    <div\n      ref={getRootRef}\n      id={contentId}\n      role=\"region\"\n      aria-labelledby={labelId}\n      aria-hidden={!expanded}\n      className={classNames(styles['AccordionContent'], className)}\n      {...restProps}\n    >\n      <div\n        ref={inRef}\n        className={classNames(styles['AccordionContent__in'], stateClassNames[animationState])}\n        {...animationHandlers}\n      >\n        {children}\n      </div>\n    </div>\n  );\n};\n\nAccordionContent.displayName = 'AccordionContent';\n"],"names":["AccordionContent","CUSTOM_PROPERTY_ACCORDION_CONTENT_HEIGHT","stateClassNames","enter","entering","entered","exit","exiting","exited","getRootRef","getRef","className","children","restProps","expanded","labelId","contentId","React","useContext","AccordionContext","inRef","useExternRef","animationState","animationHandlers","useCSSKeyframesAnimationController","undefined","useIsomorphicLayoutEffect","inEl","current","style","setProperty","scrollHeight","removeProperty","div","ref","id","role","aria-labelledby","aria-hidden","classNames","displayName"],"mappings":";;;;+BAyBaA;;;eAAAA;;;;;;;;iEAzBU;sBACI;8BACE;2BACsB;2CACT;kCAET;AAGjC,MAAMC,2CAA2C;AAEjD,MAAMC,kBAAkB;IACtBC,KAAK;IACLC,QAAQ;IACRC,OAAO;IACPC,IAAI;IACJC,OAAO;IACPC,MAAM;AACR;AAOO,MAAMR,mBAAoD;QAAC,EAChES,UAAU,EACVC,MAAM,EACNC,SAAS,EACTC,QAAQ,EAET,WADIC;QAJHJ;QACAC;QACAC;QACAC;;IAGA,MAAM,EAAEE,QAAQ,EAAEC,OAAO,EAAEC,SAAS,EAAE,GAAGC,OAAMC,UAAU,CAACC,kCAAgB;IAE1E,MAAMC,QAAQC,IAAAA,0BAAY,EAACX;IAC3B,MAAM,CAACY,gBAAgBC,kBAAkB,GAAGC,IAAAA,6CAAkC,EAC5EV,WAAW,UAAU,QACrBW,WACA;IAGFC,IAAAA,oDAAyB,EAAC;QACxB,MAAMC,OAAOP,MAAMQ,OAAO;QAE1B,6EAA6E,GAC7E,IAAI,CAACD,MAAM;YACT;QACF;QAEA,OAAQL;YACN,KAAK;YACL,KAAK;gBACHK,KAAKE,KAAK,CAACC,WAAW,CAAC7B,0CAA0C,CAAC,EAAE0B,KAAKI,YAAY,CAAC,EAAE,CAAC;gBACzF;YACF,KAAK;YACL,KAAK;gBACHJ,KAAKE,KAAK,CAACG,cAAc,CAAC/B;gBAC1B;QACJ;IACF,GAAG;QAACqB;QAAgBF;KAAM;IAE1B,qBACE,qBAACa;QACCC,KAAKzB;QACL0B,IAAInB;QACJoB,MAAK;QACLC,mBAAiBtB;QACjBuB,eAAa,CAACxB;QACdH,WAAW4B,IAAAA,gBAAU,0BAA6B5B;OAC9CE;kBAEJ,cAAA,qBAACoB;YACCC,KAAKd;YACLT,WAAW4B,IAAAA,gBAAU,8BAAiCrC,eAAe,CAACoB,eAAe;WACjFC;sBAEHX;;;AAIT;AAEAZ,iBAAiBwC,WAAW,GAAG"}