{"version":3,"sources":["../../../../../src/components/Checkbox/CheckboxInput/CheckboxInput.tsx"],"sourcesContent":["import * as React from 'react';\nimport {\n  Icon20CheckBoxIndetermanate,\n  Icon20CheckBoxOff,\n  Icon20CheckBoxOn,\n  Icon24CheckBoxOff,\n  Icon24CheckBoxOn,\n} from '@vkontakte/icons';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useAdaptivityConditionalRender } from '../../../hooks/useAdaptivityConditionalRender';\nimport { useExternRef } from '../../../hooks/useExternRef';\nimport { usePlatform } from '../../../hooks/usePlatform';\nimport { warnOnce } from '../../../lib/warnOnce';\nimport type { HasRef, HasRootRef } from '../../../types';\nimport { RootComponent } from '../../RootComponent/RootComponent';\nimport { VisuallyHidden } from '../../VisuallyHidden/VisuallyHidden';\nimport styles from './CheckboxInput.module.css';\n\nfunction setIndeterminate(el: HTMLInputElement, indeterminate: boolean) {\n  el.indeterminate = indeterminate;\n}\n\nexport interface CheckboxInputProps\n  extends React.ComponentProps<'input'>,\n    HasRootRef<HTMLDivElement>,\n    HasRef<HTMLInputElement> {\n  indeterminate?: boolean;\n  defaultIndeterminate?: boolean;\n}\n\nconst warn = warnOnce('Checkbox');\n\nexport function CheckboxInput({\n  className,\n  style,\n  getRootRef,\n  getRef,\n  indeterminate,\n  defaultIndeterminate,\n  onChange,\n  ...restProps\n}: CheckboxInputProps) {\n  const inputRef = useExternRef(getRef);\n  const platform = usePlatform();\n  const { sizeY: adaptiveSizeY } = useAdaptivityConditionalRender();\n\n  React.useEffect(() => {\n    const indeterminateValue = indeterminate === undefined ? defaultIndeterminate : indeterminate;\n\n    if (inputRef.current) {\n      setIndeterminate(inputRef.current, Boolean(indeterminateValue));\n    }\n  }, [defaultIndeterminate, indeterminate, inputRef]);\n\n  const handleChange = React.useCallback(\n    (event: React.ChangeEvent<HTMLInputElement>) => {\n      if (\n        defaultIndeterminate !== undefined &&\n        indeterminate === undefined &&\n        restProps.checked === undefined &&\n        inputRef.current\n      ) {\n        setIndeterminate(inputRef.current, false);\n      }\n      if (indeterminate !== undefined && inputRef.current) {\n        setIndeterminate(inputRef.current, Boolean(indeterminate));\n      }\n      onChange && onChange(event);\n    },\n    [defaultIndeterminate, indeterminate, restProps.checked, onChange, inputRef],\n  );\n\n  if (process.env.NODE_ENV === 'development') {\n    if (defaultIndeterminate && restProps.defaultChecked) {\n      warn('defaultIndeterminate и defaultChecked не могут быть true одновременно', 'error');\n    }\n\n    if (indeterminate && restProps.checked) {\n      warn('indeterminate и checked не могут быть true одновременно', 'error');\n    }\n\n    if (restProps.defaultChecked && restProps.checked) {\n      warn('defaultChecked и checked не могут быть true одновременно', 'error');\n    }\n  }\n\n  return (\n    <RootComponent\n      baseClassName={styles['CheckboxInput']}\n      className={className}\n      style={style}\n      getRootRef={getRootRef}\n    >\n      <VisuallyHidden\n        {...restProps}\n        Component=\"input\"\n        type=\"checkbox\"\n        onChange={handleChange}\n        className={styles['CheckboxInput__input']}\n        getRootRef={inputRef}\n      />\n      {platform === 'vkcom' ? (\n        <Icon20CheckBoxOn className={styles['CheckboxInput__icon--on']} />\n      ) : (\n        <React.Fragment>\n          {adaptiveSizeY.compact && (\n            <Icon20CheckBoxOn\n              className={classNames(\n                styles['CheckboxInput__icon--on'],\n                adaptiveSizeY.compact.className,\n              )}\n            />\n          )}\n          {adaptiveSizeY.regular && (\n            <Icon24CheckBoxOn\n              className={classNames(\n                styles['CheckboxInput__icon--on'],\n                adaptiveSizeY.regular.className,\n              )}\n            />\n          )}\n        </React.Fragment>\n      )}\n      {platform === 'vkcom' ? (\n        <Icon20CheckBoxOff className={styles['CheckboxInput__icon--off']} />\n      ) : (\n        <React.Fragment>\n          {adaptiveSizeY.compact && (\n            <Icon20CheckBoxOff\n              className={classNames(\n                styles['CheckboxInput__icon--off'],\n                adaptiveSizeY.compact.className,\n              )}\n            />\n          )}\n          {adaptiveSizeY.regular && (\n            <Icon24CheckBoxOff\n              className={classNames(\n                styles['CheckboxInput__icon--off'],\n                adaptiveSizeY.regular.className,\n              )}\n            />\n          )}\n        </React.Fragment>\n      )}\n      {platform === 'vkcom' ? (\n        <Icon20CheckBoxIndetermanate\n          width={20}\n          height={20}\n          className={styles['CheckboxInput__icon--indeterminate']}\n        />\n      ) : (\n        <React.Fragment>\n          {adaptiveSizeY.compact && (\n            <Icon20CheckBoxIndetermanate\n              className={classNames(\n                styles['CheckboxInput__icon--indeterminate'],\n                adaptiveSizeY.compact.className,\n              )}\n              width={20}\n              height={20}\n            />\n          )}\n          {adaptiveSizeY.regular && (\n            <Icon20CheckBoxIndetermanate\n              className={classNames(\n                styles['CheckboxInput__icon--indeterminate'],\n                adaptiveSizeY.regular.className,\n              )}\n              width={24}\n              height={24}\n            />\n          )}\n        </React.Fragment>\n      )}\n    </RootComponent>\n  );\n}\n"],"names":["CheckboxInput","setIndeterminate","el","indeterminate","warn","warnOnce","className","style","getRootRef","getRef","defaultIndeterminate","onChange","restProps","inputRef","useExternRef","platform","usePlatform","sizeY","adaptiveSizeY","useAdaptivityConditionalRender","React","useEffect","indeterminateValue","undefined","current","Boolean","handleChange","useCallback","event","checked","process","env","NODE_ENV","defaultChecked","RootComponent","baseClassName","VisuallyHidden","Component","type","Icon20CheckBoxOn","Fragment","compact","classNames","regular","Icon24CheckBoxOn","Icon20CheckBoxOff","Icon24CheckBoxOff","Icon20CheckBoxIndetermanate","width","height"],"mappings":"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"}