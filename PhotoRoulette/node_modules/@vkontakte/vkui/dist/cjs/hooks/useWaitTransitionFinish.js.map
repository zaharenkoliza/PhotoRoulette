{"version":3,"sources":["../../../src/hooks/useWaitTransitionFinish.ts"],"sourcesContent":["import * as React from 'react';\nimport { noop } from '@vkontakte/vkjs';\nimport { useDOM } from '../lib/dom';\n\nexport const useWaitTransitionFinish = (): ((\n  element: HTMLElement | undefined | null,\n  eventHandler: VoidFunction,\n  durationFallback: number,\n) => void) => {\n  const timeoutRef = React.useRef<ReturnType<typeof setTimeout> | null>(null);\n  const { document } = useDOM();\n  const detach = React.useRef(noop);\n\n  const remove = React.useCallback(() => {\n    detach.current();\n    detach.current = noop;\n  }, []);\n\n  const waitTransitionFinish = React.useCallback(\n    (\n      element: HTMLElement | undefined | null,\n      eventHandler: VoidFunction,\n      durationFallback: number,\n    ) => {\n      if (element) {\n        if (!document?.hidden) {\n          remove();\n          element.addEventListener('transitionend', eventHandler);\n          detach.current = () => {\n            element.removeEventListener('transitionend', eventHandler);\n          };\n        } else {\n          if (timeoutRef?.current) {\n            clearTimeout(timeoutRef.current);\n          }\n          timeoutRef.current = setTimeout(eventHandler, durationFallback);\n        }\n      }\n    },\n    [document, remove, timeoutRef],\n  );\n\n  return waitTransitionFinish;\n};\n"],"names":["useWaitTransitionFinish","timeoutRef","React","useRef","document","useDOM","detach","noop","remove","useCallback","current","waitTransitionFinish","element","eventHandler","durationFallback","hidden","addEventListener","removeEventListener","clearTimeout","setTimeout"],"mappings":";;;;+BAIaA;;;eAAAA;;;;iEAJU;sBACF;qBACE;AAEhB,MAAMA,0BAA0B;IAKrC,MAAMC,aAAaC,OAAMC,MAAM,CAAuC;IACtE,MAAM,EAAEC,QAAQ,EAAE,GAAGC,IAAAA,WAAM;IAC3B,MAAMC,SAASJ,OAAMC,MAAM,CAACI,UAAI;IAEhC,MAAMC,SAASN,OAAMO,WAAW,CAAC;QAC/BH,OAAOI,OAAO;QACdJ,OAAOI,OAAO,GAAGH,UAAI;IACvB,GAAG,EAAE;IAEL,MAAMI,uBAAuBT,OAAMO,WAAW,CAC5C,CACEG,SACAC,cACAC;QAEA,IAAIF,SAAS;YACX,IAAI,EAACR,qBAAAA,+BAAAA,SAAUW,MAAM,GAAE;gBACrBP;gBACAI,QAAQI,gBAAgB,CAAC,iBAAiBH;gBAC1CP,OAAOI,OAAO,GAAG;oBACfE,QAAQK,mBAAmB,CAAC,iBAAiBJ;gBAC/C;YACF,OAAO;gBACL,IAAIZ,uBAAAA,iCAAAA,WAAYS,OAAO,EAAE;oBACvBQ,aAAajB,WAAWS,OAAO;gBACjC;gBACAT,WAAWS,OAAO,GAAGS,WAAWN,cAAcC;YAChD;QACF;IACF,GACA;QAACV;QAAUI;QAAQP;KAAW;IAGhC,OAAOU;AACT"}